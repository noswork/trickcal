/* Common site-wide styles: header/navbar/footer and utilities shared across pages */

/* 引入使用計數器樣式 */
@import url('../usage-counter.css');

/* 引入通知系統樣式 */
@import url('../notification.css');

/* ==================== 字體定義 ==================== */
@font-face {
  font-family: "TrickcalCJK";
  src: url("../../assets/fonts/荆南波波黑-BOLD.ttf") format("truetype");
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

/* ==================== 全域變數 ==================== */
:root {
  /* 版面配置 */
  --site-max-width: 1400px;
  --site-font: "TrickcalCJK", "Noto Sans TC", "PingFang TC", "Microsoft JhengHei", system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
  --page-switcher-board-icon: url('../../assets/icons/gold_crayon.png');
  --page-switcher-sweep-icon: url('../../assets/favicons/favicon.png');
  /* 自定義游標 */
  --cursor-default: auto;
  --cursor-pointer: url('../../assets/cursors/pointer-cursor.png') 16 16, pointer;
  --cursor-text: text;
  
  /* 背景資源 */
  --bg-image: url('../../assets/backgrounds/background.png');
  --bg-image-jpg: url('../../assets/backgrounds/background.jpg');
  --bg-video: url('../../assets/backgrounds/background.mp4');
  
  /* 主題顏色 - 淺色模式 */
  --accent: #ff5f72;
  --accent-hover: #ff8f9f;
  --text-primary: #1a1a1a;
  --text-secondary: #666;
  --bg-overlay: rgba(255, 255, 255, 0.6);
  --bg-overlay-strong: rgba(255, 255, 255, 0.95);
  --border-color: rgba(0, 0, 0, 0.08);
  --border-color-hover: rgba(0, 0, 0, 0.2);
  
  /* 陰影 */
  --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.1);
  --shadow-md: 0 2px 6px rgba(0, 0, 0, 0.12);
  --shadow-lg: 0 4px 12px rgba(0, 0, 0, 0.15);
  --shadow-xl: 0 8px 24px rgba(0, 0, 0, 0.18);

  --layout-gutter: 1.5rem;
  --panel-width: 300px;
  --insight-width: 280px;
  --content-padding: clamp(16px, 4vw, 32px);
}

@media (max-width: 1440px) {
  :root {
    --panel-width: 280px;
    --insight-width: 260px;
    --layout-gutter: 1.25rem;
  }
}

@media (max-width: 1200px) {
  :root {
    --panel-width: 260px;
  }
}

@media (max-width: 992px) {
  :root {
    --layout-gutter: 1rem;
  }
}

/* 深色模式變數 */
body[data-theme="dark"] {
  --accent: #ff8f9f;
  --accent-hover: #ffb0bb;
  --text-primary: #ffffff;
  --text-secondary: #e5e5e5;
  --bg-overlay: rgba(0, 0, 0, 0.3);
  --bg-overlay-strong: rgba(0, 0, 0, 0.6);
  --border-color: rgba(255, 255, 255, 0.12);
  --border-color-hover: rgba(255, 255, 255, 0.3);
  
  --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.3);
  --shadow-md: 0 2px 6px rgba(0, 0, 0, 0.35);
  --shadow-lg: 0 4px 12px rgba(0, 0, 0, 0.4);
  --shadow-xl: 0 8px 24px rgba(0, 0, 0, 0.45);
}

html, body { min-height: 100%; }
body {
  margin: 0;
  display: flex;
  flex-direction: column;
  font-family: var(--site-font);
}

.site-header {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;
  padding: 12px var(--content-padding);
}

.site-brand {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  font-weight: 700;
}

.site-nav {
  display: inline-flex;
  align-items: center;
  gap: 12px;
}

.site-nav a {
  text-decoration: none;
}

.site-footer-min {
  width: 100%;
  display: flex;
  justify-content: center;
  padding: 10px 16px;
}

.site-container {
  max-width: var(--site-max-width);
  margin: 0 auto;
  width: 100%;
  padding-inline: var(--content-padding);
  box-sizing: border-box;
}

.board-layout {
  max-width: var(--site-max-width);
  margin: 0 auto;
  width: 100%;
  padding-inline: var(--content-padding);
  display: grid;
  grid-template-columns: minmax(0, var(--panel-width, 300px)) minmax(0, 1fr) minmax(0, var(--insight-width, 280px));
  gap: var(--layout-gutter, 1.5rem);
  box-sizing: border-box;
}

.board-layout aside,
.board-layout section {
  min-height: 0;
}

#siteHeader {
  position: sticky;
  position: -webkit-sticky;
  top: 0;
  width: 100%;
  z-index: 20;
}

/* Sweep-like top nav shared */
nav.top-nav {
  height: var(--nav-height, 64px);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  padding: 0 var(--content-padding);
  position: sticky;
  position: -webkit-sticky;
  top: env(safe-area-inset-top, 0px);
  z-index: 21;
  background: rgba(255, 255, 255, 0.6);
  -webkit-backdrop-filter: blur(10px);
  backdrop-filter: blur(10px);
  border-bottom: 1px solid rgba(0, 0, 0, 0.08);
  font-family: var(--site-font);
}

body[data-theme="dark"] nav.top-nav {
  background: rgba(0, 0, 0, 0.3);
  color: #ffffff;
  border-bottom-color: rgba(255, 255, 255, 0.12);
}

.top-nav .brand {
  display: inline-flex;
  align-items: center;
  gap: 14px;
  font-weight: 700;
  font-size: 20px;
  font-family: var(--site-font);
}

.top-nav .brand .page-name {
  white-space: nowrap;
  max-width: 180px;
  overflow: hidden;
  text-overflow: ellipsis;
}

.nav-controls {
  display: flex;
  align-items: center;
  gap: 16px;
  font-family: var(--site-font);
}

.nav-controls .language-selector-container {
  display: flex;
  align-items: center;
}

.mode-toggle {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 40px;
  height: 40px;
  border-radius: 10px;
  border: 1px solid rgba(0, 0, 0, 0.12);
  background: rgba(255, 255, 255, 0.6);
  transition: all 0.2s ease;
}

body[data-theme="dark"] .mode-toggle {
  border-color: rgba(255, 255, 255, 0.2);
  background: rgba(255, 255, 255, 0.08);
}

.mode-toggle:hover {
  border-color: var(--accent, #ff5f72);
  background: rgba(255, 255, 255, 0.7);
}

body[data-theme="dark"] .mode-toggle:hover {
  border-color: var(--accent-dark, #ff8f9f);
  background: rgba(255, 255, 255, 0.18);
}

.mode-toggle .icon {
  width: 22px;
  height: 22px;
  fill: none;
  stroke: currentColor;
  stroke-width: 2;
  stroke-linecap: round;
  stroke-linejoin: round;
  transition: transform 0.3s ease;
}

.mode-toggle:hover .icon {
  transform: rotate(15deg) scale(1.05);
}

.mode-toggle .icon-sun {
  color: #ff9500;
}

body[data-theme="dark"] .mode-toggle .icon-sun {
  color: #ffa500;
}

.mode-toggle .icon-moon {
  display: none;
  color: #9ca3af;
}

body[data-theme="dark"] .mode-toggle .icon-moon {
  color: #d1d5db;
}

body[data-theme="dark"] .mode-toggle .icon-sun { display: none; }
body[data-theme="dark"] .mode-toggle .icon-moon { display: inline; }

/* Page switcher */
.page-switcher { position: relative; }
.page-switcher-toggle {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  height: 40px;
  padding: 0 12px;
  border-radius: 10px;
  border: 1px solid rgba(0,0,0,0.12);
  background: rgba(255,255,255,0.6);
  color: #1a1a1a;
  font-family: var(--site-font);
}
body[data-theme="dark"] .page-switcher-toggle {
  border-color: rgba(255,255,255,0.2);
  background: rgba(255,255,255,0.08);
  color: #ffffff;
}
.page-switcher-menu {
  position: absolute;
  left: 0;
  top: calc(100% + 8px);
  min-width: 200px;
  background: rgba(255,255,255,0.95);
  -webkit-backdrop-filter: blur(10px);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(0,0,0,0.08);
  border-radius: 12px;
  padding: 8px;
  margin: 0;
  list-style: none;
  box-shadow: 0 6px 24px rgba(0,0,0,0.1);
  transform: translateY(6px);
  transform-origin: top left;
  opacity: 0;
  transition: all .16s ease;
  visibility: hidden;
  display: flex;
  flex-direction: column;
  gap: 4px;
  align-items: stretch;
}
.page-switcher-menu li {
  width: 100%;
}
.page-switcher-menu li a {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 14px;
  border-radius: 8px;
  color: inherit;
  text-decoration: none;
  font-family: var(--site-font);
  white-space: nowrap;
  justify-content: flex-start;
}
.page-switcher-menu li a img {
  width: 16px;
  height: 16px;
  object-fit: contain;
}
body .page-switcher-menu li a[data-page="board"] img {
  content: var(--page-switcher-board-icon);
}
body .page-switcher-menu li a[data-page="sweep"] img {
  content: var(--page-switcher-sweep-icon);
}

body[data-page-kind="board"],
body[data-page-kind="sweep"],
body[data-page-kind="root"] {
  --page-switcher-board-icon: url('../../assets/icons/gold_crayon.png');
  --page-switcher-sweep-icon: url('../../assets/favicons/favicon.png');
}

.page-switcher-menu li a:hover { background: rgba(0,0,0,0.06); }
body[data-theme="dark"] .page-switcher-menu { background: rgba(0,0,0,0.6); border-color: rgba(255,255,255,0.12); }
body[data-theme="dark"] .page-switcher-menu li a:hover { background: rgba(255,255,255,0.12); }

/* 展開狀態 */
.page-switcher[data-open="true"] .page-switcher-menu {
  opacity: 1;
  visibility: visible;
  transform: translateY(0);
}

.page-switcher-toggle:hover,
.page-switcher[data-open="true"] .page-switcher-toggle {
  border-color: var(--accent, #ff5f72);
  background: rgba(255, 255, 255, 0.8);
}

body[data-theme="dark"] .page-switcher-toggle:hover,
body[data-theme="dark"] .page-switcher[data-open="true"] .page-switcher-toggle {
  border-color: var(--accent, #ff8f9f);
  background: rgba(255, 255, 255, 0.15);
}

.page-switcher[data-open="true"] .page-switcher-toggle .caret {
  transform: rotate(180deg);
}

.page-switcher-toggle .caret {
  transition: transform 0.2s ease;
}

/* Language selector (unified) */
.language-selector { position: relative; }
.language-toggle {
  display: inline-flex; align-items: center; gap: 8px;
  height: 40px; padding: 0 12px; border-radius: 10px;
  border: 1px solid rgba(0,0,0,0.12); background: rgba(255,255,255,0.6);
  color: currentColor;
  transition: all 0.2s ease;
  font-family: var(--site-font);
}
.language-caret {
  font-size: 12px;
  transition: transform 0.2s ease;
}
.language-selector[data-open="true"] .language-caret {
  transform: rotate(180deg);
}
body[data-theme="dark"] .language-toggle { border-color: rgba(255,255,255,0.2); background: rgba(255,255,255,0.08); }
.language-toggle:hover,
.language-selector[data-open="true"] .language-toggle {
  border-color: var(--accent, #ff5f72); background: rgba(255,255,255,0.7);
}
body[data-theme="dark"] .language-toggle:hover,
body[data-theme="dark"] .language-selector[data-open="true"] .language-toggle {
  border-color: var(--accent-dark, #ff8f9f); background: rgba(255,255,255,0.18);
}
.language-menu {
  position: absolute; right: 0; top: calc(100% + 8px); min-width: 180px; list-style: none;
  margin: 0; padding: 8px; border-radius: 12px;
  background: rgba(255,255,255,0.95); -webkit-backdrop-filter: blur(10px); backdrop-filter: blur(10px);
  border: 1px solid rgba(0,0,0,0.08); box-shadow: 0 6px 24px rgba(0,0,0,0.1);
  opacity: 0; visibility: hidden; transform: translateY(6px); transition: all .16s ease;
}
.language-selector[data-open="true"] .language-menu { opacity: 1; visibility: visible; transform: translateY(0); }
.language-menu li { padding: 8px 10px; border-radius: 8px; transition: background 0.2s ease; }
.language-menu li:hover,
.language-menu li[aria-selected="true"] { background: rgba(0,0,0,0.06); }
body[data-theme="dark"] .language-menu { background: rgba(0,0,0,0.6); border-color: rgba(255,255,255,0.12); }
body[data-theme="dark"] .language-menu li:hover,
body[data-theme="dark"] .language-menu li[aria-selected="true"] { background: rgba(255,255,255,0.12); }

/* Footer (reusing sweep style) */
.site-footer {
  background: rgba(255, 255, 255, 0.5);
  -webkit-backdrop-filter: blur(12px);
  backdrop-filter: blur(12px);
  border-top: 1px solid rgba(0, 0, 0, 0.08);
  padding: 12px var(--content-padding);
  position: relative;
  z-index: 5;
  font-family: var(--site-font);
}
body[data-theme="dark"] .site-footer { background: rgba(0,0,0,0.3); border-top-color: rgba(255,255,255,0.12); }
.footer-content { display:flex; justify-content:space-between; align-items:center; gap:16px; max-width:1400px; margin:0 auto; flex-wrap:wrap; }
.footer-main { flex:1; display:flex; align-items:center; gap:8px; flex-wrap:wrap; font-size:12px; color: var(--text-secondary, #666); }
body[data-theme="dark"] .footer-main { color: var(--text-secondary-dark, #e5e5e5); }
.footer-text, .footer-license, .footer-copyright-inline { margin:0; font-size:12px; }
.footer-separator { opacity:.5; }
.footer-contact { display:flex; align-items:center; gap:16px; }
.discord-link { display:inline-flex; align-items:center; gap:6px; padding:6px 12px; background:rgba(88,101,242,.1); border:1px solid rgba(88,101,242,.3); border-radius:999px; color:#5865F2; text-decoration:none; transition:all .2s ease; font-weight:500; font-size:12px; }
.discord-link:hover { background:rgba(88,101,242,.2); border-color:rgba(88,101,242,.5); transform: translateY(-1px); }
body[data-theme="dark"] .discord-link { background:rgba(88,101,242,.15); border-color:rgba(88,101,242,.4); color:#7289da; }
body[data-theme="dark"] .discord-link:hover { background:rgba(88,101,242,.25); border-color:rgba(88,101,242,.6); }
.discord-icon { width:16px; height:16px; flex-shrink:0; }

@media (max-width: 1024px) {
  nav.top-nav {
    flex-wrap: wrap;
    row-gap: 10px;
    min-height: 56px;
  }
  .nav-controls {
    flex-wrap: wrap;
    justify-content: flex-end;
    row-gap: 8px;
  }
}

@media (max-width: 768px) {
  nav.top-nav {
    flex-direction: column;
    align-items: stretch;
    gap: 12px;
    padding-block: 12px;
  }
  .top-nav .brand {
    font-size: 16px;
    gap: 10px;
    flex-wrap: wrap;
    align-items: center;
  }
  .top-nav .brand .page-switcher {
    flex: 1 1 100%;
  }
  .top-nav .brand .page-name {
    max-width: 100%;
  }
  .nav-controls {
    width: 100%;
    justify-content: space-between;
    column-gap: 10px;
  }
  .nav-controls > * {
    flex: 1 1 48%;
  }
  .mode-toggle { width: 40px; height: 40px; flex: 0 0 auto; }
  .mode-toggle .icon { width: 20px; height: 20px; }
}

@media (max-width: 640px) {
  .use-counter { display: none; }
  nav.top-nav {
    gap: 10px;
  }
  .nav-controls {
    gap: 8px;
  }
  .nav-controls > * {
    flex: 1 1 100%;
  }
  .top-nav .brand {
    align-items: flex-start;
  }
  .page-switcher,
  .language-selector-container {
    width: 100%;
  }
  .page-switcher-toggle,
  .language-toggle {
    justify-content: space-between;
    width: 100%;
  }

  body.with-background {
    background-attachment: scroll;
  }

  .site-container {
    padding-inline: clamp(16px, 5vw, 24px);
  }
}

@media (max-width: 540px) {
  .site-header {
    padding-inline: clamp(12px, 6vw, 18px);
  }
  nav.top-nav {
    padding-inline: clamp(12px, 6vw, 18px);
  }
}

/* ==================== 背景系統 ==================== */
/* 背景視頻 - 添加 .with-background-video class 到 body 以啟用 */
.background-video {
  position: fixed;
  top: 50%;
  left: 50%;
  min-width: 100%;
  min-height: 100%;
  width: auto;
  height: auto;
  transform: translate(-50%, -50%);
  z-index: -1;
  object-fit: cover;
  will-change: auto;
}

body[data-theme="dark"] .background-video {
  filter: brightness(0.6);
}

/* 背景圖片 - 添加 .with-background class 到 body 以啟用 */
body.with-background {
  background-image: var(--bg-image);
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
  background-repeat: no-repeat;
}

/* 在移動設備上使用靜態背景而非視頻以提升性能 */
@media (max-width: 768px) {
  .background-video {
    display: none;
  }
  
  body.with-background-video {
    background-image: var(--bg-image-jpg);
    background-size: cover;
    background-position: center;
    background-attachment: scroll; /* 在移動設備上使用scroll而不是fixed以提升性能 */
  }
}

/* ==================== 通用工具類 ==================== */
/* 禁用文字選取 */
.no-select {
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  -webkit-touch-callout: none;
  -webkit-user-drag: none;
}

/* 啟用平滑滾動 */
.smooth-scroll {
  -webkit-overflow-scrolling: touch;
  scroll-behavior: smooth;
}

/* 玻璃效果面板 */
.glass-panel {
  background: var(--bg-overlay);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  border: 1px solid var(--border-color);
  border-radius: 12px;
}

/* 使用計數器樣式 */
.use-counter {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 6px 12px;
  border-radius: 10px;
  background: rgba(255, 255, 255, 0.6);
  border: 1px solid rgba(0, 0, 0, 0.12);
  font-size: 14px;
  font-family: var(--site-font);
}

body[data-theme="dark"] .use-counter {
  background: rgba(255, 255, 255, 0.08);
  border-color: rgba(255, 255, 255, 0.2);
}

.counter-icon {
  width: 16px;
  height: 16px;
  animation: rotate 4s linear infinite;
}

@keyframes rotate {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

.counter-value {
  font-weight: 600;
  min-width: 20px;
  text-align: center;
}

/* ==================== 自定義游標（最高優先級）==================== */
/* 必須放在 CSS 文件的最後，確保覆蓋所有其他樣式 */
*,
*::before,
*::after {
  cursor: var(--cursor-pointer) !important;
}

input,
input::placeholder,
textarea,
textarea::placeholder,
[contenteditable],
[contenteditable="true"] {
  cursor: var(--cursor-text) !important;
}

.sweep-layout {
  max-width: var(--site-max-width);
  margin: 0 auto;
  width: 100%;
  padding: 24px 32px 32px;
  display: grid;
  grid-template-columns: 1.5fr 1fr;
  gap: 24px;
  min-height: 0;
}

.panel {
  display: flex;
  flex-direction: column;
  border-radius: var(--panel-radius, 18px);
  padding: 20px 24px;
  backdrop-filter: blur(18px);
  -webkit-backdrop-filter: blur(18px);
  border: 1px solid var(--border-color-light, rgba(0, 0, 0, 0.08));
  background: var(--panel-bg-light, rgba(255, 255, 255, 0.45));
  color: inherit;
  min-height: 0;
}

body[data-theme="dark"] .panel {
  border-color: var(--border-color, rgba(255, 255, 255, 0.18));
  background: var(--panel-bg, rgba(34, 34, 34, 0.45));
}

